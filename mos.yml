author: mark dornbach
platform: esp8266
description: a minimal firmware for ota flashing tasmota from mongoose os
version: 0.2.1

libs_version:        latest
modules_version:     latest
mongoose_os_version: latest
manifest_version:    2017-09-29
sources:             [src]
filesystem:          [fs]
tags:                [c, tuya, tasmota, mongoose]

# Custom configuration
config_schema:
  #### sys ####
  - ["debug.level", 2]                     # 0 = ERROR, 1 = WARN, 2 = INFO, 3+ = DEBUG
  #### wifi ####
  - ["wifi.ap.enable",             false ]
  - ["wifi.sta.enable",             true ] # join wifi as client
  - ["sta_connect_timeout",           30 ] # timeout for wifi connection / seconds
  - ["wifi.sta1.ssid",    "mgos-recover" ] # fallback SSID
  - ["wifi.sta1.pass",      "RJoPuKC3u5" ] # fallback password

# External libs
libs:
  - origin: https://github.com/mongoose-os-libs/boards                  # board definitions library
  - origin: https://github.com/mongoose-os-libs/ota-common              # OTA support
  - origin: https://github.com/mongoose-os-libs/rpc-common              # shared RPC API
  - origin: https://github.com/mongoose-os-libs/rpc-uart                # RPC via serial console
  - origin: https://github.com/mongoose-os-libs/rpc-service-config      # manage device configuration remotely
  - origin: https://github.com/mongoose-os-libs/ca-bundle               # CA certificates

build_vars:
  FLASH_SIZE: 2097152
  FS_SIZE: 262144

conds:
  - when: build_vars.MODEL == "Shelly1"
    apply:
      name: switch1
